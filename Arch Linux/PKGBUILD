# Maintainer: Jesse Spangenberger <azulephoenix@gmail.com>

pkgname=notepadqq-git
_pkgname=notepadqq
pkgver=0.32.0.r9.g3c62167
pkgrel=1
pkgdesc="A Linux clone of Notepad++"
arch=('i686' 'x86_64')
url="http://notepadqq.altervista.org/wp/"
license=('GPL3')
depends=('qt5-webkit=5.3.1' 'hicolor-icon-theme' 'desktop-file-utils' 'file')
provides=('notepadqq')
conflicts=('notepadqq-bin')
makedepends=('qt5-base')

sha1sums=('SKIP'
          '3f522228673391ab18e5bdf3cd90724d75074d8c')

source=(git+https://github.com/notepadqq/notepadqq.git
        "${_pkgname}.install")

pkgver() {
	cd "${srcdir}/${_pkgname}"
	git describe --long | sed -r 's/([^-]*-g)/r\1/;s/-/./g;s/^v//g'
}

build() {
	cd ${srcdir}/${_pkgname}/src/ui
	
	 qmake-qt5 PREFIX=${pkgdir}/usr notepadqq.pro -r -spec linux-g++
	 make
	
}

package() {
	cd ${srcdir}/${_pkgname}/src/ui
	make DESTDIR=${pkgdir}/usr install
	
	cd ${srcdir}/${_pkgname}
	
	install -dm 755 "${pkgdir}/usr/bin"
	install -Dm 755 out/release/bin/notepadqq-bin "${pkgdir}/usr/bin"
	install -Dm 755 out/release/bin/notepadqq "${pkgdir}/usr/bin"
	
	install -dm 755 "${pkgdir}/usr/share/notepadqq"
	cp -r out/release/appdata/editor/ "${pkgdir}/usr/share/notepadqq"
	
	install -Dm644 "${pkgdir}/usr/share/icons/hicolor/scalable/apps/${_pkgname}.svg" "${pkgdir}/usr/share/pixmaps/${_pkgname}.svg"
}
